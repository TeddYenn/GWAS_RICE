<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>5 Extra Analysis and Visualization | GWAS Tutorial</title>
<meta name="author" content="Yen-Hsiang (Teddy) Huang">
<meta name="description" content="5.1 Geographic Information Create a world map showcasing the percentage distribution of the origins of 327 rice samples, represented using a gradient color scale.  ➡️ Working on R (RStudio) #####...">
<meta name="generator" content="bookdown 0.40 with bs4_book()">
<meta property="og:title" content="5 Extra Analysis and Visualization | GWAS Tutorial">
<meta property="og:type" content="book">
<meta property="og:url" content="https://github.com/TeddYenn/GWAS_RICE/sec-extra.html">
<meta property="og:image" content="https://github.com/TeddYenn/GWAS_RICE/images/cover.png">
<meta property="og:description" content="5.1 Geographic Information Create a world map showcasing the percentage distribution of the origins of 327 rice samples, represented using a gradient color scale.  ➡️ Working on R (RStudio) #####...">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="5 Extra Analysis and Visualization | GWAS Tutorial">
<meta name="twitter:description" content="5.1 Geographic Information Create a world map showcasing the percentage distribution of the origins of 327 rice samples, represented using a gradient color scale.  ➡️ Working on R (RStudio) #####...">
<meta name="twitter:image" content="https://github.com/TeddYenn/GWAS_RICE/images/cover.png">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><link href="libs/Lato-0.4.9/font.css" rel="stylesheet">
<link href="libs/Roboto_Mono-0.4.9/font.css" rel="stylesheet">
<link href="libs/Montserrat-0.4.9/font.css" rel="stylesheet">
<script src="libs/bs3compat-0.8.0/transition.js"></script><script src="libs/bs3compat-0.8.0/tabs.js"></script><script src="libs/bs3compat-0.8.0/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><style type="text/css">
    
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  </style>
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="For Anaerobic Germination in Rice">GWAS Tutorial</a>:
        <small class="text-muted">For Anaerobic Germination in Rice</small>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html">Welcome to GWAS Tutorial</a></li>
<li><a class="" href="preface.html">Preface</a></li>
<li><a class="" href="sec-genotype-data.html"><span class="header-section-number">1</span> Genotype Data</a></li>
<li><a class="" href="sec-phenotype-data.html"><span class="header-section-number">2</span> Phenotype Data</a></li>
<li><a class="" href="sec-gw.html"><span class="header-section-number">3</span> GWAS</a></li>
<li><a class="" href="sec-post-gwas.html"><span class="header-section-number">4</span> Post-GWAS</a></li>
<li><a class="active" href="sec-extra.html"><span class="header-section-number">5</span> Extra Analysis and Visualization</a></li>
<li><a class="" href="sec-findings.html"><span class="header-section-number">6</span> Findings</a></li>
<li><a class="" href="sec-summary.html"><span class="header-section-number">7</span> Summary</a></li>
</ul>

        <div class="book-extra">
          <p><a id="book-repo" href="https://github.com/TeddYenn/GWAS_RICE">View book source <i class="fab fa-github"></i></a></p>
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="sec-extra" class="section level1" number="5">
<h1>
<span class="header-section-number">5</span> Extra Analysis and Visualization<a class="anchor" aria-label="anchor" href="#sec-extra"><i class="fas fa-link"></i></a>
</h1>
<div id="geographic-information" class="section level2" number="5.1">
<h2>
<span class="header-section-number">5.1</span> <strong>Geographic Information</strong><a class="anchor" aria-label="anchor" href="#geographic-information"><i class="fas fa-link"></i></a>
</h2>
<p>Create a world map showcasing the percentage distribution of the origins of 327 rice samples, represented using a gradient color scale.</p>
<div class="inline-figure"><img src="images/clipboard-1499951598.png" width="600"></div>
<details><summary>
➡️ <strong>Working on R (RStudio)</strong>
</summary><div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">##### R CODES #####</span></span>
<span></span>
<span><span class="co"># Set the working directory for initial setup</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/getwd.html">setwd</a></span><span class="op">(</span><span class="st">"...change..."</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Load the phenotype data from a CSV file</span></span>
<span><span class="va">Pheno_data</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html">read.csv</a></span><span class="op">(</span><span class="st">"IRRI_311_Pheno_AG_Clean_ID_Sorted.csv"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Extract the origin information and create a frequency table</span></span>
<span><span class="va">origin</span> <span class="op">=</span> <span class="va">Pheno_data</span><span class="op">$</span><span class="va">Origin</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">origin</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Create a data frame with region names, counts, and percentages</span></span>
<span><span class="va">data</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span></span>
<span>  <span class="st">"region"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">origin</span><span class="op">)</span><span class="op">)</span>,  <span class="co"># Region names</span></span>
<span>  <span class="st">"number"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">origin</span><span class="op">)</span><span class="op">)</span>,  <span class="co"># Number of occurrences per region</span></span>
<span>  <span class="st">"perc"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">origin</span><span class="op">)</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">Pheno_data</span><span class="op">$</span><span class="va">Origin</span><span class="op">)</span>  <span class="co"># Percentage per region</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Load ggplot2 for visualization and map_data for world map data</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org">ggplot2</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/options.html">options</a></span><span class="op">(</span>scipen <span class="op">=</span> <span class="fl">999</span><span class="op">)</span>  <span class="co"># Disable scientific notation for readability</span></span>
<span><span class="va">world</span> <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/map_data.html">map_data</a></span><span class="op">(</span><span class="st">"world"</span><span class="op">)</span>  <span class="co"># Load world map data</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/vcfR/man/vcfR-method.html">head</a></span><span class="op">(</span><span class="va">world</span><span class="op">)</span>  <span class="co"># Preview the world map data</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/write.table.html">write.csv</a></span><span class="op">(</span><span class="va">world</span>, <span class="st">"world_map.csv"</span><span class="op">)</span>  <span class="co"># Save the world map data to a CSV file for reference</span></span>
<span></span>
<span><span class="co"># Rename specific regions in the data frame for consistency with map data</span></span>
<span><span class="va">data</span><span class="op">[</span><span class="fl">4</span>, <span class="fl">1</span><span class="op">]</span> <span class="op">=</span> <span class="st">"Brunei"</span></span>
<span><span class="va">data</span><span class="op">[</span><span class="fl">5</span>, <span class="fl">1</span><span class="op">]</span> <span class="op">=</span> <span class="st">"Burkina Faso"</span></span>
<span><span class="va">data</span><span class="op">[</span><span class="fl">11</span>, <span class="fl">1</span><span class="op">]</span> <span class="op">=</span> <span class="st">"Ivory Coast"</span></span>
<span><span class="va">data</span><span class="op">[</span><span class="fl">20</span>, <span class="fl">1</span><span class="op">]</span> <span class="op">=</span> <span class="st">"Laos"</span></span>
<span><span class="va">data</span><span class="op">[</span><span class="fl">31</span>, <span class="fl">1</span><span class="op">]</span> <span class="op">=</span> <span class="st">"Sierra Leone"</span></span>
<span><span class="va">data</span><span class="op">[</span><span class="fl">32</span>, <span class="fl">1</span><span class="op">]</span> <span class="op">=</span> <span class="st">"Solomon Islands"</span></span>
<span><span class="va">data</span><span class="op">[</span><span class="fl">33</span>, <span class="fl">1</span><span class="op">]</span> <span class="op">=</span> <span class="st">"Sri Lanka"</span></span>
<span><span class="va">data</span><span class="op">[</span><span class="fl">36</span>, <span class="fl">1</span><span class="op">]</span> <span class="op">=</span> <span class="st">"Vietnam"</span></span>
<span><span class="va">data</span><span class="op">[</span><span class="fl">37</span>, <span class="fl">1</span><span class="op">]</span> <span class="op">=</span> <span class="st">"Niger"</span></span>
<span></span>
<span><span class="co"># Save the updated region information to a CSV file</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/write.table.html">write.csv</a></span><span class="op">(</span><span class="va">data</span>, <span class="st">"origin_map.csv"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Read the processed origin map data</span></span>
<span><span class="va">origin_map</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html">read.csv</a></span><span class="op">(</span><span class="st">"origin_map.csv"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Load additional libraries for data manipulation</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org">dplyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://stringr.tidyverse.org">stringr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org">ggplot2</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Merge the world map data with the origin map data by region</span></span>
<span><span class="va">worldSubset</span> <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html">inner_join</a></span><span class="op">(</span><span class="va">world</span>, <span class="va">origin_map</span>, by <span class="op">=</span> <span class="st">"region"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">worldSubset</span><span class="op">$</span><span class="va">region</span><span class="op">)</span>  <span class="co"># Check the frequency of regions in the subset</span></span>
<span></span>
<span><span class="co"># Define a minimalist theme for the plot</span></span>
<span><span class="va">plain</span> <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span></span>
<span>  axis.text <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span>,  <span class="co"># Remove axis text</span></span>
<span>  axis.line <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span>,  <span class="co"># Remove axis lines</span></span>
<span>  axis.ticks <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span>,  <span class="co"># Remove axis ticks</span></span>
<span>  panel.border <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span>,  <span class="co"># Remove panel border</span></span>
<span>  panel.grid <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span>,  <span class="co"># Remove grid lines</span></span>
<span>  axis.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span>,  <span class="co"># Remove axis titles</span></span>
<span>  panel.background <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_rect</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"white"</span><span class="op">)</span>,  <span class="co"># Set panel background to white</span></span>
<span>  plot.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>hjust <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span>  <span class="co"># Center the plot title</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Create a world map visualization with percentage-based fill</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">worldSubset</span>, mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">long</span>, y <span class="op">=</span> <span class="va">lat</span>, group <span class="op">=</span> <span class="va">group</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># Add the base world map with light gray fill</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_polygon.html">geom_polygon</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">world</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">long</span>, y <span class="op">=</span> <span class="va">lat</span>, group <span class="op">=</span> <span class="va">group</span><span class="op">)</span>,</span>
<span>               fill <span class="op">=</span> <span class="st">"#f7f6f6"</span>, color <span class="op">=</span> <span class="st">"#999999"</span>, linewidth <span class="op">=</span> <span class="fl">0.01</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># Fill regions based on percentage</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_polygon.html">geom_polygon</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="va">perc</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># Define a gradient color scale for the fill</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_gradient.html">scale_fill_gradient</a></span><span class="op">(</span></span>
<span>    low <span class="op">=</span> <span class="st">"#f2d489"</span>,  <span class="co"># Low percentage color</span></span>
<span>    high <span class="op">=</span> <span class="st">"#e8542d"</span>,  <span class="co"># High percentage color</span></span>
<span>    name <span class="op">=</span> <span class="st">"Percentage (%)"</span>,  <span class="co"># Legend title</span></span>
<span>    breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">4</span>, <span class="fl">8</span>, <span class="fl">12</span><span class="op">)</span>,  <span class="co"># Breaks for the legend</span></span>
<span>    labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"4"</span>, <span class="st">"8"</span>, <span class="st">"12"</span><span class="op">)</span>,  <span class="co"># Labels for the legend</span></span>
<span>    guide <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guide_colourbar.html">guide_colorbar</a></span><span class="op">(</span></span>
<span>      barwidth <span class="op">=</span> <span class="fl">10</span>,  <span class="co"># Width of the color bar</span></span>
<span>      barheight <span class="op">=</span> <span class="fl">1.2</span>  <span class="co"># Height of the color bar</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="va">plain</span> <span class="op">+</span>  <span class="co"># Apply the minimalist theme</span></span>
<span>  <span class="co"># Customize the legend appearance and position</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span></span>
<span>    legend.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">14</span><span class="op">)</span>,  <span class="co"># Legend title font size</span></span>
<span>    legend.text <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">12</span><span class="op">)</span>,  <span class="co"># Legend text font size</span></span>
<span>    legend.position <span class="op">=</span> <span class="st">"bottom"</span>  <span class="co"># Position the legend at the bottom</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="co"># Final plot size recommendation: 7' x 4'</span></span></code></pre></div>
</details><hr>
</div>
<div id="linkage-disequilibrium-ld-decay-across-genome" class="section level2" number="5.2">
<h2>
<span class="header-section-number">5.2</span> Linkage Disequilibrium (LD) Decay Across Genome<a class="anchor" aria-label="anchor" href="#linkage-disequilibrium-ld-decay-across-genome"><i class="fas fa-link"></i></a>
</h2>
<p>Computation and visualization of LD decay. First, utilizes PLINK to thin SNPs (10%) and calculate pairwise LD (r²) within specified distance windows (1000 Kb). Then, Analyzes PLINK output to compute average r² across distance intervals (<code>window.size</code>), summarizing LD decay patterns. Finally, generates a smooth LD decay plot, highlighting the relationship between physical distance (kb) and LD (r²).</p>
<div class="inline-figure"><img src="images/clipboard-2982375851.png" width="600"></div>
<details><summary>
➡️ <strong>Working on PLINK in the terminal</strong>
</summary><div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="sec-extra.html#cb29-1" tabindex="-1"></a><span class="do">##### PLINK COMMANDS #####</span></span>
<span id="cb29-2"><a href="sec-extra.html#cb29-2" tabindex="-1"></a></span>
<span id="cb29-3"><a href="sec-extra.html#cb29-3" tabindex="-1"></a><span class="co"># Change your path into the directory of the 'IRRI_18M_311'</span></span>
<span id="cb29-4"><a href="sec-extra.html#cb29-4" tabindex="-1"></a><span class="co"># cd ...your file path...</span></span>
<span id="cb29-5"><a href="sec-extra.html#cb29-5" tabindex="-1"></a></span>
<span id="cb29-6"><a href="sec-extra.html#cb29-6" tabindex="-1"></a>.<span class="sc">/</span>plink <span class="sc">--</span>bfile IRRI_1<span class="fl">.9</span>M_327 <span class="sc">--</span>thin <span class="fl">0.1</span> <span class="sc">--</span>set<span class="sc">-</span>hh<span class="sc">-</span>missing <span class="sc">--</span>r2 <span class="sc">--</span>ld<span class="sc">-</span>window<span class="sc">-</span>r2 <span class="dv">0</span> <span class="sc">--</span>ld<span class="sc">-</span>window <span class="dv">99999</span> <span class="sc">--</span>ld<span class="sc">-</span>window<span class="sc">-</span>kb <span class="dv">1000</span> <span class="sc">--</span>out IRRI_190K_327_LD</span></code></pre></div>
</details><details><summary>
➡️ <strong>Working on R (RStudio)</strong>
</summary><div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">##### R CODES #####</span></span>
<span></span>
<span><span class="co"># Set the working directory for initial setup</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/getwd.html">setwd</a></span><span class="op">(</span><span class="st">"...change..."</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Load the required library</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://r-datatable.com">data.table</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Read the input data file containing LD information</span></span>
<span><span class="va">LD</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/data.table/man/fread.html">fread</a></span><span class="op">(</span><span class="st">"IRRI_190K_311_LD.ld"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Function to calculate LD decay</span></span>
<span><span class="va">LD.decay</span> <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">data</span>, <span class="va">window.size</span><span class="op">)</span><span class="op">{</span> </span>
<span>  <span class="co"># Order the data by distance</span></span>
<span>  <span class="va">ld1</span> <span class="op">=</span> <span class="va">data</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/order.html">order</a></span><span class="op">(</span><span class="va">data</span><span class="op">[</span>, <span class="fl">5</span><span class="op">]</span> <span class="op">-</span> <span class="va">data</span><span class="op">[</span>, <span class="fl">2</span><span class="op">]</span><span class="op">)</span>, <span class="op">]</span></span>
<span>  <span class="va">distance</span> <span class="op">=</span> <span class="va">ld1</span><span class="op">[</span>, <span class="fl">5</span><span class="op">]</span> <span class="op">-</span> <span class="va">ld1</span><span class="op">[</span>, <span class="fl">2</span><span class="op">]</span>  <span class="co"># Calculate distance between loci</span></span>
<span>  <span class="va">ld_distance</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="va">distance</span>, R2 <span class="op">=</span> <span class="va">ld1</span><span class="op">$</span><span class="va">R2</span><span class="op">)</span>  <span class="co"># Create a data frame with distance and R² values</span></span>
<span>  </span>
<span>  <span class="co"># Define blocks for the distance intervals</span></span>
<span>  <span class="va">block</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="va">ld_distance</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span><span class="op">)</span>, by <span class="op">=</span> <span class="va">window.size</span><span class="op">)</span></span>
<span>  <span class="va">ld2</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">block</span><span class="op">)</span><span class="op">)</span>  <span class="co"># Initialize an array to store mean R² values</span></span>
<span>  <span class="va">decay</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="va">block</span>, <span class="va">ld2</span><span class="op">)</span>  <span class="co"># Create a data frame to store LD decay information</span></span>
<span>  </span>
<span>  <span class="co"># Initialize a progress bar</span></span>
<span>  <span class="va">pb</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/utils/txtProgressBar.html">txtProgressBar</a></span><span class="op">(</span>min <span class="op">=</span> <span class="fl">0</span>, max <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">block</span><span class="op">)</span>, style <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="co"># Loop through each block to calculate mean R²</span></span>
<span>  <span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq_along</a></span><span class="op">(</span><span class="va">block</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="co"># Subset data within the current block range</span></span>
<span>    <span class="va">intv</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">ld_distance</span>, <span class="op">(</span><span class="va">ld_distance</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span> <span class="op">&gt;=</span> <span class="va">block</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&amp;</span> <span class="va">ld_distance</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span> <span class="op">&lt;</span> <span class="op">(</span><span class="va">block</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">+</span> <span class="va">window.size</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="co"># Compute the mean R² for the current block</span></span>
<span>    <span class="va">decay</span><span class="op">[</span><span class="va">i</span>, <span class="fl">2</span><span class="op">]</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">intv</span><span class="op">[</span>, <span class="fl">2</span><span class="op">]</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span>    <span class="co"># Update the progress bar</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/utils/txtProgressBar.html">setTxtProgressBar</a></span><span class="op">(</span><span class="va">pb</span>, <span class="va">i</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span>  </span>
<span>  <span class="co"># Close the progress bar</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/connections.html">close</a></span><span class="op">(</span><span class="va">pb</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="va">decay</span><span class="op">)</span>  <span class="co"># Return the LD decay data frame</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># Run the LD decay function with a window size of 1000</span></span>
<span><span class="va">LD.decay</span> <span class="op">=</span> <span class="fu">LD.decay</span><span class="op">(</span>data <span class="op">=</span> <span class="va">LD</span>, window.size <span class="op">=</span> <span class="fl">1000</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Save the LD decay data as an RDS file</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/readRDS.html">saveRDS</a></span><span class="op">(</span><span class="va">LD.decay</span>, <span class="st">"IRRI_190K_327_LD.rds"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Load the saved LD decay data</span></span>
<span><span class="va">LD.decay</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html">readRDS</a></span><span class="op">(</span><span class="st">"IRRI_190K_327_LD.rds"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Load ggplot2 for visualization</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org">ggplot2</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Plot LD decay</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">LD.decay</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Distance (kb)"</span>, y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html">expression</a></span><span class="op">(</span><span class="va">r</span><span class="op">^</span><span class="op">{</span><span class="fl">2</span><span class="op">}</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>  <span class="co"># Axis labels with proper formatting</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">block</span>, y <span class="op">=</span> <span class="va">ld2</span><span class="op">)</span>, color <span class="op">=</span> <span class="st">"#d3a02f"</span>, size <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span>  <span class="co"># Add a line plot for LD decay</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_x_continuous</a></span><span class="op">(</span></span>
<span>    limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.0</span>, <span class="fl">4.5</span><span class="op">*</span><span class="fl">10</span><span class="op">^</span><span class="fl">5</span><span class="op">)</span>,  <span class="co"># Set x-axis limits</span></span>
<span>    breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">*</span><span class="fl">10</span><span class="op">^</span><span class="fl">5</span>, <span class="fl">2</span><span class="op">*</span><span class="fl">10</span><span class="op">^</span><span class="fl">5</span>, <span class="fl">3</span><span class="op">*</span><span class="fl">10</span><span class="op">^</span><span class="fl">5</span>, <span class="fl">4</span><span class="op">*</span><span class="fl">10</span><span class="op">^</span><span class="fl">5</span><span class="op">)</span>,  <span class="co"># Define breaks</span></span>
<span>    labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"0"</span>, <span class="st">"100"</span>, <span class="st">"200"</span>, <span class="st">"300"</span>, <span class="st">"400"</span><span class="op">)</span>,  <span class="co"># Label breaks in kb</span></span>
<span>    expand <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.01</span>, <span class="fl">0</span><span class="op">)</span>  <span class="co"># Adjust axis expansion</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_y_continuous</a></span><span class="op">(</span></span>
<span>    limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.0</span>, <span class="fl">0.65</span><span class="op">)</span>,  <span class="co"># Set y-axis limits</span></span>
<span>    breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0.2</span>, <span class="fl">0.4</span>, <span class="fl">0.6</span><span class="op">)</span>,  <span class="co"># Define breaks</span></span>
<span>    labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"0.0"</span>, <span class="st">"0.2"</span>, <span class="st">"0.4"</span>, <span class="st">"0.6"</span><span class="op">)</span>,  <span class="co"># Label breaks</span></span>
<span>    expand <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.03</span>, <span class="fl">0</span><span class="op">)</span>  <span class="co"># Adjust axis expansion</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_classic</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>  <span class="co"># Apply a classic theme</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span></span>
<span>    axis.title.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">18</span><span class="op">)</span>,  <span class="co"># Customize x-axis title font size</span></span>
<span>    axis.title.y <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">18</span>, vjust <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>,  <span class="co"># Customize y-axis title font size and position</span></span>
<span>    axis.text.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">16</span><span class="op">)</span>,  <span class="co"># Customize x-axis text font size</span></span>
<span>    axis.text.y <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">16</span><span class="op">)</span>   <span class="co"># Customize y-axis text font size</span></span>
<span>  <span class="op">)</span></span>
<span>  </span>
<span><span class="co"># Final plot size recommendation: 6' x 4'</span></span></code></pre></div>
</details><hr>
</div>
<div id="genetic-pattern" class="section level2" number="5.3">
<h2>
<span class="header-section-number">5.3</span> Genetic Pattern<a class="anchor" aria-label="anchor" href="#genetic-pattern"><i class="fas fa-link"></i></a>
</h2>
<div class="inline-figure"><img src="images/clipboard-1482032998.png" width="600"></div>
<div class="inline-figure"><img src="images/clipboard-2271077002.png" width="600"></div>
<details><summary>
➡️ <strong>Working on PLINK in the terminal</strong>
</summary><div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">##### PLINK COMMANDS ##### </span></span>
<span></span>
<span><span class="co"># Change your path into the directory of the 'IRRI_18M_327'</span></span>
<span><span class="co"># cd ...your file path...</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/system.html">system</a></span><span class="op">(</span><span class="st">"plink --bfile IRRI_404K_3024 --pca 3024"</span><span class="op">)</span></span></code></pre></div>
</details><details><summary>
➡️ <strong>Working on R (RStudio)</strong>
</summary><div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">##### R CODES #####</span></span>
<span></span>
<span><span class="co"># Set the working directory for initial setup</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/getwd.html">setwd</a></span><span class="op">(</span><span class="st">"...change..."</span><span class="op">)</span></span>
<span></span>
<span><span class="va">eigenval</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html">read.table</a></span><span class="op">(</span><span class="st">"plink.eigenval"</span><span class="op">)</span></span>
<span><span class="va">eigenval</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">eigenval</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">eigenval</span> <span class="op">=</span> <span class="va">eigenval</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/which.html">which</a></span><span class="op">(</span><span class="va">eigenval</span><span class="op">&gt;</span><span class="fl">0</span><span class="op">)</span><span class="op">]</span></span>
<span></span>
<span><span class="co">##### Eigenvalue of PCA from plink #####</span></span>
<span><span class="va">variance_proportion</span> <span class="op">=</span> <span class="va">eigenval</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">eigenval</span><span class="op">)</span> <span class="co"># PC1: 8.11%; PC2: 4.17%; PC3: 2.52%</span></span>
<span><span class="va">variance_proportion</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">50</span><span class="op">]</span><span class="op">*</span><span class="fl">100</span></span>
<span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org">ggplot2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://jrnold.github.io/ggthemes/">ggthemes</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">plot_pca_variance</span> <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">variance_proportion</span>, <span class="va">num_pcs</span> <span class="op">=</span> <span class="fl">15</span>, <span class="va">num_bins</span> <span class="op">=</span> <span class="fl">4</span><span class="op">)</span> <span class="op">{</span></span>
<span>  </span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html">is.numeric</a></span><span class="op">(</span><span class="va">variance_proportion</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="kw"><a href="https://rdrr.io/r/base/stop.html">stop</a></span><span class="op">(</span><span class="st">"variance_proportion must be a numeric vector"</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span>  </span>
<span>  <span class="va">variance_data</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span></span>
<span>    PCs <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="va">num_pcs</span>,</span>
<span>    PV <span class="op">=</span> <span class="va">variance_proportion</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="va">num_pcs</span><span class="op">]</span> <span class="op">*</span> <span class="fl">100</span>,  <span class="co"># Proportion of Variance</span></span>
<span>    CV <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cumsum.html">cumsum</a></span><span class="op">(</span><span class="va">variance_proportion</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="va">num_pcs</span><span class="op">]</span> <span class="op">*</span> <span class="fl">100</span><span class="op">)</span>  <span class="co"># Cumulative Proportion</span></span>
<span>  <span class="op">)</span></span>
<span>  <span class="va">col</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="st">"#765635"</span>, <span class="va">num_bins</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="st">"#e5d5c5"</span>, <span class="va">num_pcs</span> <span class="op">-</span> <span class="va">num_bins</span><span class="op">)</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">ylim.PV</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">10</span><span class="op">)</span></span>
<span>  <span class="va">ylim.CP</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">100</span><span class="op">)</span></span>
<span>  <span class="va">b</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/diff.html">diff</a></span><span class="op">(</span><span class="va">ylim.PV</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/diff.html">diff</a></span><span class="op">(</span><span class="va">ylim.CP</span><span class="op">)</span></span>
<span>  <span class="va">a</span> <span class="op">=</span> <span class="va">ylim.PV</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">-</span> <span class="va">b</span> <span class="op">*</span> <span class="va">ylim.CP</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span></span>
<span>  </span>
<span>  <span class="va">plot</span> <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">variance_data</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">PCs</span>, y <span class="op">=</span> <span class="va">PV</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_bar</a></span><span class="op">(</span>stat <span class="op">=</span> <span class="st">"identity"</span>, show.legend <span class="op">=</span> <span class="cn">FALSE</span>, fill <span class="op">=</span> <span class="va">col</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">a</span> <span class="op">+</span> <span class="va">CV</span> <span class="op">*</span> <span class="va">b</span><span class="op">)</span>, color <span class="op">=</span> <span class="st">"grey30"</span>, lwd <span class="op">=</span> <span class="fl">1.5</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">a</span> <span class="op">+</span> <span class="va">CV</span> <span class="op">*</span> <span class="va">b</span><span class="op">)</span>, color <span class="op">=</span> <span class="st">"grey10"</span>, size <span class="op">=</span> <span class="fl">4</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">xlab</a></span><span class="op">(</span><span class="st">"Principal components axis"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_x_continuous</a></span><span class="op">(</span>breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">5</span>, <span class="fl">10</span>, <span class="fl">15</span>, <span class="va">num_pcs</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_y_continuous</a></span><span class="op">(</span><span class="st">"Proportion of variance (%)"</span>, limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">10</span><span class="op">)</span>, </span>
<span>                       sec.axis <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/sec_axis.html">sec_axis</a></span><span class="op">(</span><span class="op">~</span><span class="op">(</span><span class="va">.</span> <span class="op">-</span> <span class="va">a</span><span class="op">)</span> <span class="op">/</span> <span class="va">b</span>, name <span class="op">=</span> <span class="st">"Cumulative proportion (%)"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="http://jrnold.github.io/ggthemes/reference/theme_base.html">theme_base</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span></span>
<span>      axis.title.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">16</span><span class="op">)</span>,</span>
<span>      axis.title.y.left <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">16</span>, color <span class="op">=</span> <span class="st">"#765635"</span><span class="op">)</span>,</span>
<span>      axis.title.y.right <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">16</span>, color <span class="op">=</span> <span class="st">"grey10"</span><span class="op">)</span>,</span>
<span>      axis.text.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">14</span><span class="op">)</span>,</span>
<span>      axis.text.y.left <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">13</span><span class="op">)</span>,</span>
<span>      axis.text.y.right <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">13</span>, color <span class="op">=</span> <span class="st">"grey10"</span><span class="op">)</span></span>
<span>    <span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="va">plot</span><span class="op">)</span> <span class="co"># SIZE: A6</span></span>
<span><span class="op">}</span></span>
<span><span class="fu">plot_pca_variance</span><span class="op">(</span><span class="va">variance_proportion</span>, num_pcs <span class="op">=</span> <span class="fl">20</span>, num_bins <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span>
<span></span>
<span><span class="co">##### Eigenvector of PCA from plink #####</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://r-datatable.com">data.table</a></span><span class="op">)</span></span>
<span><span class="va">eigenvec</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/data.table/man/fread.html">fread</a></span><span class="op">(</span><span class="st">"plink.eigenvec"</span><span class="op">)</span></span>
<span><span class="va">eigenvec</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span><span class="op">(</span><span class="va">eigenvec</span><span class="op">[</span>, <span class="fl">2</span><span class="op">:</span><span class="fl">6</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">eigenvec</span><span class="op">)</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"ID"</span>, <span class="st">"PC1"</span>, <span class="st">"PC2"</span>, <span class="st">"PC3"</span>, <span class="st">"PC4"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/getwd.html">setwd</a></span><span class="op">(</span><span class="st">"C:/Users/teddy/Desktop/TAMU/P1/404K/327"</span><span class="op">)</span></span>
<span><span class="va">ID</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html">read.csv</a></span><span class="op">(</span><span class="st">"327in3024.csv"</span><span class="op">)</span></span>
<span><span class="va">data</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span><span class="va">ID</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">4</span>,<span class="fl">5</span>,<span class="fl">6</span><span class="op">)</span><span class="op">]</span>, <span class="va">eigenvec</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># PCA Scatter Plot: PC1 vs PC2</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org">ggplot2</a></span><span class="op">)</span></span>
<span><span class="va">PC1v2</span> <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">data</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">PC1</span>, y <span class="op">=</span> <span class="va">PC2</span>, color <span class="op">=</span> <span class="va">GWAS</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">3</span>, alpha <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"PC 1 (8.11%)"</span>, y <span class="op">=</span> <span class="st">"PC 2 (4.17%)"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_classic</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span></span>
<span>    axis.title.x <span class="op">=</span>   <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">16</span><span class="op">)</span>,</span>
<span>    axis.title.y <span class="op">=</span>   <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">16</span><span class="op">)</span>,</span>
<span>    axis.text.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">10</span><span class="op">)</span>,</span>
<span>    axis.text.y <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">10</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_color_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"grey"</span>,<span class="st">"#bd9233"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">PC1v2</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">data</span>, <span class="va">GWAS</span> <span class="op">==</span> <span class="st">"TRUE"</span><span class="op">)</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">PC1</span>, <span class="va">PC2</span><span class="op">)</span>, color <span class="op">=</span> <span class="st">"#bd9233"</span>, size <span class="op">=</span> <span class="fl">3</span>, alpha <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">data</span>, <span class="va">GWAS</span> <span class="op">==</span> <span class="st">"TRUE"</span><span class="op">)</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">PC1</span>, <span class="va">PC2</span><span class="op">)</span>, color <span class="op">=</span> <span class="st">"#bd9233"</span>, size <span class="op">=</span> <span class="fl">3</span>, shape <span class="op">=</span> <span class="fl">20</span><span class="op">)</span></span>
<span><span class="co"># 5*7</span></span>
<span></span>
<span><span class="co"># PCA Scatter Plot: PC1 vs PC3</span></span>
<span><span class="va">PC1v3</span> <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">data</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">PC1</span>, y <span class="op">=</span> <span class="va">PC3</span>, color <span class="op">=</span> <span class="va">GWAS</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">3</span>, alpha <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"PC 1 (8.11%)"</span>, y <span class="op">=</span> <span class="st">"PC 3 (2.52%)"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_classic</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span></span>
<span>    axis.title.x <span class="op">=</span>   <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">16</span><span class="op">)</span>,</span>
<span>    axis.title.y <span class="op">=</span>   <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">16</span><span class="op">)</span>,</span>
<span>    axis.text.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">10</span><span class="op">)</span>,</span>
<span>    axis.text.y <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">10</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_color_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"grey"</span>,<span class="st">"#bd9233"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">PC1v3</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">data</span>, <span class="va">GWAS</span> <span class="op">==</span> <span class="st">"TRUE"</span><span class="op">)</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">PC1</span>, <span class="va">PC3</span><span class="op">)</span>, color <span class="op">=</span> <span class="st">"#bd9233"</span>, size <span class="op">=</span> <span class="fl">3</span>, alpha <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">data</span>, <span class="va">GWAS</span> <span class="op">==</span> <span class="st">"TRUE"</span><span class="op">)</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">PC1</span>, <span class="va">PC3</span><span class="op">)</span>, color <span class="op">=</span> <span class="st">"#bd9233"</span>, size <span class="op">=</span> <span class="fl">3</span>, shape <span class="op">=</span> <span class="fl">20</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># PCA Scatter Plot: PC1 vs PC2 vs PC3</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://plotly-r.com">plotly</a></span><span class="op">)</span></span>
<span><span class="va">cols</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span></span>
<span><span class="va">text_content</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">'"&lt;/br&gt; ◉ '</span>, <span class="va">cols</span>, <span class="st">': ", data$'</span>, <span class="va">cols</span>, collapse <span class="op">=</span> <span class="st">', '</span><span class="op">)</span></span>
<span><span class="va">text</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/formula.html">as.formula</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"~paste("</span>, <span class="va">text_content</span>, <span class="st">")"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/plotly/man/plot_ly.html">plot_ly</a></span><span class="op">(</span><span class="va">data</span>, x <span class="op">=</span> <span class="op">~</span><span class="va">PC1</span>, y <span class="op">=</span> <span class="op">~</span><span class="va">PC2</span>, z <span class="op">=</span> <span class="op">~</span><span class="va">PC3</span>,</span>
<span>        type <span class="op">=</span> <span class="st">"scatter3d"</span>, mode <span class="op">=</span> <span class="st">"markers"</span>, </span>
<span>        color <span class="op">=</span> <span class="op">~</span><span class="va">GWAS</span>, colors <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"grey"</span>,<span class="st">"#bd9233"</span><span class="op">)</span>,</span>
<span>        marker <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">4</span><span class="op">)</span><span class="op">)</span>,</span>
<span>        text <span class="op">=</span> <span class="va">text</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">layout</span><span class="op">(</span>title <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>         scene <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span></span>
<span>           xaxis <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"PC1 (8.11%)"</span>, showline <span class="op">=</span> <span class="cn">TRUE</span>, showgrid <span class="op">=</span> <span class="cn">TRUE</span>, zeroline <span class="op">=</span> <span class="cn">TRUE</span>, zerolinecolor <span class="op">=</span> <span class="st">"grey"</span><span class="op">)</span>,</span>
<span>           yaxis <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"PC2 (4.17%)"</span>, showline <span class="op">=</span> <span class="cn">TRUE</span>, showgrid <span class="op">=</span> <span class="cn">TRUE</span>, zeroline <span class="op">=</span> <span class="cn">TRUE</span>, zerolinecolor <span class="op">=</span> <span class="st">"grey"</span><span class="op">)</span>,</span>
<span>           zaxis <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"PC3 (2.52%)"</span>, showline <span class="op">=</span> <span class="cn">TRUE</span>, showgrid <span class="op">=</span> <span class="cn">TRUE</span>, zeroline <span class="op">=</span> <span class="cn">TRUE</span>, zerolinecolor <span class="op">=</span> <span class="st">"grey"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</details><hr>
</div>
<div id="backup" class="section level2" number="5.4">
<h2>
<span class="header-section-number">5.4</span> <strong>Backup</strong><a class="anchor" aria-label="anchor" href="#backup"><i class="fas fa-link"></i></a>
</h2>
<div id="align-accession-ids-1" class="section level4" number="5.4.0.1">
<h4>
<span class="header-section-number">5.4.0.1</span> <strong>Align Accession IDs</strong><a class="anchor" aria-label="anchor" href="#align-accession-ids-1"><i class="fas fa-link"></i></a>
</h4>
<p>Match the accession IDs between the phenotypic data and SNP datasets. We identified three issues related to inconsistencies in the spelling, formatting, and ranking of ID names between the phenotype data and genotype datasets:</p>
<ol style="list-style-type: decimal">
<li><p>The ID names in the phenotype data must correspond precisely with those in the genotype datasets, using the Mapping Table as a reference.</p></li>
<li>
<p>The format of ID names in the Mapping Table is inconsistent with the format used in the phenotype data. For example, consider a sample named <code>EX WUKARI (WILD)::IRGC 63214-3</code>:</p>
<table class="table table-sm">
<colgroup>
<col width="33%">
<col width="33%">
<col width="33%">
</colgroup>
<thead><tr class="header">
<th>ID in Phenotype</th>
<th>ID in <a href="https://3kricegenome.s3.us-east-1.amazonaws.com/kaust_irri_3k_16refs/3K_list_sra_ids.txt">Mapping Table</a>
</th>
<th>ID in Genotype</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>EX WUKARI (WILD)::IRGC 63214-3</td>
<td>EX_WUKARI_(WILD)::IRGC_63214-1</td>
<td>IRIS_313-11657</td>
</tr>
<tr class="even">
<td></td>
<td>IRIS_313-11657</td>
<td></td>
</tr>
</tbody>
</table>
</li>
<li><p>In the genotype datasets, the rank order of ID names does not follow the correct sequence. For example, the correct order should be: <code>IRIS_313-8890</code>, <code>IRIS_313-9101</code>, and <code>IRIS_313-11657</code>, not <code>IRIS_313-11657</code>, <code>IRIS_313-8890</code>, and <code>IRIS_313-9101</code>.</p></li>
</ol>
<details><summary>
➡️ <strong>Working on R (RStudio)</strong>
</summary><div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">##### R CODES #####  # Set the working directory setwd("...your file path...")  # Load the datasets IRRI_3K = read.csv("IRRI_3K_ID.csv") # Mapping table  IRRI_341 = read.csv("IRRI_341_Pheno_AG_Original.csv") # Phenotypic Data  # Process designations in IRRI_3K dataset IRRI_3K[1:5,2] IRRI_3K_ID = gsub("_", " ", IRRI_3K[,2]) IRRI_341[1:5,1]  # Match designations between the two datasets loc = c() for (i in 1:dim(IRRI_341)[1]) {   match_index = which(IRRI_3K_ID == IRRI_341$Designation[i])   if (length(match_index) == 0) {     loc[i] = NA    } else {     loc[i] = match_index   } }  # Check for unmatched entries and summarize loc sum(is.na(loc))   # Create a new annotated data frame combining information from both datasets IRRI_341_ID = data.frame("Designation" = IRRI_341$Designation) for (i in 1:length(loc)) {   if (is.na(loc[i])) {     IRRI_341_ID$ID = NA   } else {     IRRI_341_ID$ID = IRRI_3K$X3K_DNA_IRIS_UNIQUE_ID[loc]     IRRI_341_ID$Origin = IRRI_3K$Country_Origin_updated[loc]     IRRI_341_ID$SRA = IRRI_3K$SRA[loc]     IRRI_341_ID$Control_5DAS = IRRI_341$PERCENT_SEEDGER_5DAS     IRRI_341_ID$Control_7DAS = IRRI_341$PERCENT_SEEDGER_7DAS     IRRI_341_ID$Control_14DAS = IRRI_341$PERCENT_SEEDGER_14DAS     IRRI_341_ID$AG_7DAS = IRRI_341$PERCENT_SEEDGER_7DAS_AG     IRRI_341_ID$AG_14DAS = IRRI_341$PERCENT_SEEDGER_14DAS_AG   } }  # Preview the annotated data frame head(IRRI_341_ID) tail(IRRI_341_ID)  # Save the annotated data frame to a CSV file write.csv(IRRI_341_ID, "IRRI_341_Pheno_AG_Original_ID.csv", row.names = F)  # Sort the annotated data by ID and identify specific entries IRRI_341_ID_sorted = IRRI_341_ID[order(IRRI_341_ID$ID), ] which(IRRI_341_ID_sorted$ID == "IRIS_313-7620") # 245 which(IRRI_341_ID_sorted$ID == "IRIS_313-9989") # 311 which(IRRI_341_ID_sorted$ID == "IRIS_313-10020") # 5 which(IRRI_341_ID_sorted$ID == "IRIS_313-15901") # 5  # Rearrange the data frame to exclude specific entries IRRI_311_ID_sorted = IRRI_341_ID_sorted[c(1:4, 245:311, 5:244), ]  # Save the sorted and rearranged data frame to a CSV file write.csv(IRRI_311_ID_sorted, "IRRI_311_Pheno_AG_Original_ID_Sorted.csv", row.names = F)  # Export a text file with the IDs for further analysis write.table(cbind(IRRI_311_ID_sorted$ID, IRRI_311_ID_sorted$ID), "IRRI_311_ID.txt", row.names = F, col.names = F, quote = F)</span></span></code></pre></div>
</details><details><summary><strong>Outputs</strong>
</summary><ul>
<li><p><strong>IRRI_341_Pheno_AG_Original_ID.csv</strong><br>
Annotated phenotypic data with aligned and matched ID names.</p></li>
<li><p><strong>IRRI_311_Pheno_AG_Original_ID_Sorted.csv</strong><br>
Phenotypic data that has been sorted and reorganized.</p></li>
<li><p><strong>IRRI_311_ID.txt</strong><br>
A text file containing the list of IDs.</p></li>
</ul>
<div class="inline-figure"><img src="images/output.png" width="400"></div>
</details>
</div>
</div>
</div>
  <div class="chapter-nav">
<div class="prev"><a href="sec-post-gwas.html"><span class="header-section-number">4</span> Post-GWAS</a></div>
<div class="next"><a href="sec-findings.html"><span class="header-section-number">6</span> Findings</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#sec-extra"><span class="header-section-number">5</span> Extra Analysis and Visualization</a></li>
<li><a class="nav-link" href="#geographic-information"><span class="header-section-number">5.1</span> Geographic Information</a></li>
<li><a class="nav-link" href="#linkage-disequilibrium-ld-decay-across-genome"><span class="header-section-number">5.2</span> Linkage Disequilibrium (LD) Decay Across Genome</a></li>
<li><a class="nav-link" href="#genetic-pattern"><span class="header-section-number">5.3</span> Genetic Pattern</a></li>
<li><a class="nav-link" href="#backup"><span class="header-section-number">5.4</span> Backup</a></li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
<li><a id="book-source" href="https://github.com/TeddYenn/GWAS_RICE/blob/master/05-extra-analysis-visualization.Rmd">View source <i class="fab fa-github"></i></a></li>
          <li><a id="book-edit" href="https://github.com/TeddYenn/GWAS_RICE/edit/master/05-extra-analysis-visualization.Rmd">Edit this page <i class="fab fa-github"></i></a></li>
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>GWAS Tutorial</strong>: For Anaerobic Germination in Rice" was written by Yen-Hsiang (Teddy) Huang. It was last built on 2025-01-23.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer>
</body>
</html>
